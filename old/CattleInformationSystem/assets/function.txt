CREATE OR REPLACE PROCEDURE insert_cow(in lifeNumber text,
									 in gender int,
									 in dateOfBirth timestamp,
									 inout new_cow_id int)
LANGUAGE 'plpgsql'
AS $$
BEGIN
	INSERT INTO "Cows" ("Id", "LifeNumber", "Gender", "DateOfBirth") 
	VALUES (NEXTVAL('"public"."Cows_Id_seq"'), lifeNumber, gender, dateOfBirth)	
	ON CONFLICT ("LifeNumber") DO 
		UPDATE SET "Gender" = gender, "DateOfBirth" = dateOfBirth WHERE "Cows"."LifeNumber" = lifeNumber	
	RETURNING "Id" INTO new_cow_id;
END;
$$;

CALL insert_cow('NL1234', 0, '2012-03-05 12:00:00', null);